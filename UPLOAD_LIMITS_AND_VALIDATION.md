# æ–‡ä»¶ä¸Šä¼ é™åˆ¶ä¸éªŒè¯æœºåˆ¶

## æ–‡ä»¶æ ¼å¼æ”¯æŒ

### âœ… å½“å‰æ”¯æŒçš„æ ¼å¼

| ç±»å‹ | æ‰©å±•å | è§£æå™¨ | è¯´æ˜ |
|------|--------|--------|------|
| çº¯æ–‡æœ¬ | .txt | TextParser | æ”¯æŒå¤šç§ç¼–ç è‡ªåŠ¨æ£€æµ‹ |
| Markdown | .md | MarkdownParser | æ”¯æŒè¡¨æ ¼ã€ä»£ç å—ç­‰æ‰©å±•è¯­æ³• |
| PDF | .pdf | PDFParser | æ”¯æŒåŠ å¯†PDFã€å¤šé¡µæå– |
| å›¾ç‰‡ | .jpg, .jpeg | ImageParser | GPT-4o-miniå›¾ç‰‡è¯†åˆ« |
| å›¾ç‰‡ | .png | ImageParser | æ”¯æŒé€æ˜èƒŒæ™¯ |
| å›¾ç‰‡ | .gif | ImageParser | æ”¯æŒåŠ¨ç”»å¸§ |
| å›¾ç‰‡ | .bmp | ImageParser | ä½å›¾æ ¼å¼ |
| å›¾ç‰‡ | .webp | ImageParser | ç°ä»£å›¾ç‰‡æ ¼å¼ |

**æ€»è®¡**ï¼š9ç§æ ¼å¼

### âŒ æš‚ä¸æ”¯æŒçš„æ ¼å¼

| ç±»å‹ | æ‰©å±•å | åŸå›  | æ›¿ä»£æ–¹æ¡ˆ |
|------|--------|------|----------|
| Word | .doc, .docx | éœ€è¦python-docxåº“ | è½¬æ¢ä¸ºPDFæˆ–.txt |
| Excel | .xls, .xlsx | éœ€è¦openpyxlåº“ | å¯¼å‡ºä¸ºCSVæˆ–PDF |
| PowerPoint | .ppt, .pptx | éœ€è¦python-pptxåº“ | å¯¼å‡ºä¸ºPDF |

### ğŸ”„ æœªæ¥è®¡åˆ’

å¦‚éœ€æ”¯æŒOfficeæ–‡æ¡£ï¼Œéœ€è¦ï¼š
```bash
# å®‰è£…ä¾èµ–
pip install python-docx openpyxl python-pptx

# åˆ›å»ºç›¸åº”çš„è§£æå™¨
- OfficeParser: å¤„ç†.docx, .xlsx, .pptx
- LegacyOfficeParser: å¤„ç†.doc, .xls, .pptï¼ˆéœ€è¦é¢å¤–åº“ï¼‰
```

---

## æ–‡ä»¶æ•°é‡é™åˆ¶

### åç«¯é™åˆ¶ï¼ˆç¡¬é™åˆ¶ï¼‰

```python
# backend/app/api/ingest.py

@router.post("/upload-multiple")
async def upload_multiple_files(files: List[UploadFile] = File(...)):
    # éªŒè¯æ–‡ä»¶æ•°é‡
    if len(files) > 20:
        raise HTTPException(
            status_code=400,
            detail="ä¸€æ¬¡æœ€å¤šåªèƒ½ä¸Šä¼ 20ä¸ªæ–‡ä»¶"
        )
```

**MVPé™åˆ¶å€¼**ï¼š5ä¸ªæ–‡ä»¶/æ‰¹æ¬¡ï¼ˆæ›´ä¿å®ˆï¼‰

**åŸå› **ï¼š
- MVPé˜¶æ®µä¼˜å…ˆä¿è¯ç¨³å®šæ€§
- é¿å…æœåŠ¡å™¨å†…å­˜æº¢å‡º
- æ§åˆ¶å¹¶å‘å¤„ç†å‹åŠ›
- ç¡®ä¿ç”¨æˆ·ä½“éªŒæµç•…

### å‰ç«¯éªŒè¯ï¼ˆâœ… æ–°å¢ï¼‰

```typescript
// frontend/src/pages/Home/index.tsx

beforeUpload: (file, fileList) => {
    if (isFirstFile) {
        // MVPé™åˆ¶ï¼šéªŒè¯æ–‡ä»¶æ•°é‡
        if (fileList.length > 5) {
            message.error(`MVPé˜¶æ®µä¸€æ¬¡æœ€å¤šåªèƒ½ä¸Šä¼ 5ä¸ªæ–‡ä»¶ï¼Œå½“å‰é€‰æ‹©äº†${fileList.length}ä¸ªæ–‡ä»¶`);
            return false;  // é˜»æ­¢ä¸Šä¼ 
        }
    }
}
```

**ç”¨æˆ·æç¤º**ï¼š
- âŒ è¶…è¿‡é™åˆ¶ï¼šæ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œé˜»æ­¢ä¸Šä¼ 
- â„¹ï¸ å»ºè®®ï¼šå¦‚æœ‰å¤§é‡æ–‡ä»¶ï¼Œåˆ†æ‰¹ä¸Šä¼ 

---

## æ–‡ä»¶å¤§å°é™åˆ¶

### å•ä¸ªæ–‡ä»¶å¤§å°

**MVPç¡¬é™åˆ¶**ï¼š20MBï¼ˆç›´æ¥æ‹’ç»ï¼‰
- MVPé˜¶æ®µæ›´ä¿å®ˆçš„é™åˆ¶
- è¶…è¿‡20MBç›´æ¥æ‹’ç»ä¸Šä¼ 
- ç¡®ä¿å¤„ç†é€Ÿåº¦å’Œç¨³å®šæ€§

```typescript
const maxSingleSize = 20 * 1024 * 1024; // 20MB
if ((file.size || 0) > maxSingleSize) {
    message.error(`MVPé˜¶æ®µå•ä¸ªæ–‡ä»¶ä¸èƒ½è¶…è¿‡20MBï¼Œå½“å‰æ–‡ä»¶ ${file.name} å¤§å°ä¸º ${(file.size / 1024 / 1024).toFixed(1)}MB`);
    return false;
}
```

**WebæœåŠ¡å™¨é…ç½®**ï¼š
- Nginx: `client_max_body_size 25M`ï¼ˆç•¥é«˜äºä¸šåŠ¡é™åˆ¶ï¼‰
- FastAPI: ä¸šåŠ¡å±‚éªŒè¯20MB

### æ‰¹é‡ä¸Šä¼ æ€»å¤§å°

**MVPç¡¬é™åˆ¶**ï¼š100MBï¼ˆ5ä¸ªæ–‡ä»¶Ã—20MBï¼‰

```python
max_total_size = 100 * 1024 * 1024  # 100MB (MVPé™åˆ¶)
if total_size > max_total_size:
    raise HTTPException(
        status_code=400,
        detail=f"MVPé˜¶æ®µæ‰¹é‡ä¸Šä¼ æ€»å¤§å°ä¸èƒ½è¶…è¿‡100MBï¼Œå½“å‰ï¼š{total_size / 1024 / 1024:.1f}MB"
    )
```

**å‰ç«¯éªŒè¯**ï¼ˆâœ… å·²å®ç°ï¼‰ï¼š
```typescript
const totalSize = fileList.reduce((sum, f) => sum + (f.size || 0), 0);
const maxTotalSize = 100 * 1024 * 1024; // MVP: 100MB
if (totalSize > maxTotalSize) {
    message.error(`æ‰¹é‡ä¸Šä¼ æ€»å¤§å°ä¸èƒ½è¶…è¿‡100MBï¼Œå½“å‰ï¼š${(totalSize / 1024 / 1024).toFixed(1)}MB`);
    return false;
}
```

---

## è¾¹ç•Œä¿æŠ¤æœºåˆ¶

### 1. å‰ç«¯éªŒè¯ï¼ˆç¬¬ä¸€é“é˜²çº¿ï¼‰

```typescript
éªŒè¯æ—¶æœºï¼šç”¨æˆ·é€‰æ‹©æ–‡ä»¶åï¼Œä¸Šä¼ å‰

éªŒè¯é¡¹ç›®ï¼š
âœ… æ–‡ä»¶æ ¼å¼ï¼ˆé€šè¿‡acceptå±æ€§ï¼‰
âœ… æ–‡ä»¶æ•°é‡ï¼ˆæœ€å¤š20ä¸ªï¼‰
âœ… æ€»æ–‡ä»¶å¤§å°ï¼ˆæœ€å¤š500MBï¼‰
âœ… å•ä¸ªæ–‡ä»¶å¤§å°ï¼ˆè¶…è¿‡50MBè­¦å‘Šï¼‰

å¤„ç†æ–¹å¼ï¼š
- ä¸ç¬¦åˆæ¡ä»¶ï¼šæ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œé˜»æ­¢ä¸Šä¼ 
- è­¦å‘Šæƒ…å†µï¼šæ˜¾ç¤ºè­¦å‘Šï¼Œå…è®¸ç»§ç»­
```

### 2. åç«¯éªŒè¯ï¼ˆç¬¬äºŒé“é˜²çº¿ï¼‰

```python
éªŒè¯æ—¶æœºï¼šæ¥æ”¶åˆ°ä¸Šä¼ è¯·æ±‚æ—¶

éªŒè¯é¡¹ç›®ï¼š
âœ… æ–‡ä»¶æ ¼å¼ï¼ˆDocumentProcessor.is_supportedï¼‰
âœ… æ–‡ä»¶æ•°é‡ï¼ˆlen(files) > 20ï¼‰
âœ… æ€»æ–‡ä»¶å¤§å°ï¼ˆtotal_size > 500MBï¼‰

å¤„ç†æ–¹å¼ï¼š
- è¿”å›HTTP 400é”™è¯¯
- æä¾›æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯
- ä¸è¿›è¡Œä»»ä½•å¤„ç†
```

### 3. è¿è¡Œæ—¶ä¿æŠ¤

```python
å†…å­˜ä¿æŠ¤ï¼š
- æ–‡ä»¶ç«‹å³ä¿å­˜åˆ°ç£ç›˜
- ä¸åœ¨å†…å­˜ä¸­ä¿ç•™å®Œæ•´æ–‡ä»¶
- æµå¼å¤„ç†å¤§æ–‡ä»¶

å¹¶å‘ä¿æŠ¤ï¼š
- æ™ºèƒ½å¹¶å‘æ§åˆ¶ï¼ˆ2-5ä¸ªï¼‰
- é˜Ÿåˆ—ä¼˜å…ˆçº§ç®¡ç†
- æ‰¹æ¬¡é—´å»¶è¿Ÿï¼ˆ200msï¼‰

è¶…æ—¶ä¿æŠ¤ï¼š
- ä»»åŠ¡è¶…æ—¶è‡ªåŠ¨ç»ˆæ­¢
- å‰ç«¯è½®è¯¢è¶…æ—¶æœºåˆ¶
- è‡ªåŠ¨é™çº§å¤„ç†
```

---

## ç”¨æˆ·æç¤ºç³»ç»Ÿ

### é”™è¯¯æç¤ºåˆ†ç±»

#### 1. æ ¼å¼é”™è¯¯
```
âŒ ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: {filename}
å»ºè®®ï¼šè¯·ä¸Šä¼ æ”¯æŒçš„æ ¼å¼ï¼ˆ.txt, .md, .pdf, å›¾ç‰‡ç­‰ï¼‰
```

#### 2. æ•°é‡è¶…é™
```
âŒ ä¸€æ¬¡æœ€å¤šåªèƒ½ä¸Šä¼ 20ä¸ªæ–‡ä»¶ï¼Œå½“å‰é€‰æ‹©äº†{count}ä¸ªæ–‡ä»¶
å»ºè®®ï¼šè¯·åˆ†æ‰¹ä¸Šä¼ ï¼Œæˆ–å‡å°‘æ–‡ä»¶æ•°é‡
```

#### 3. å¤§å°è¶…é™
```
âŒ æ–‡ä»¶æ€»å¤§å°ä¸èƒ½è¶…è¿‡500MBï¼Œå½“å‰ï¼š{size}MB
å»ºè®®ï¼šè¯·å‡å°‘æ–‡ä»¶æ•°é‡æˆ–é€‰æ‹©è¾ƒå°çš„æ–‡ä»¶
```

#### 4. æ€§èƒ½è­¦å‘Š
```
âš ï¸ ä»¥ä¸‹æ–‡ä»¶è¶…è¿‡50MBï¼Œå¯èƒ½å¤„ç†è¾ƒæ…¢ï¼š{filenames}
è¯´æ˜ï¼šæ–‡ä»¶ä¼šæ­£å¸¸å¤„ç†ï¼Œä½†å¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´
```

### æˆåŠŸæç¤º

#### å•æ–‡ä»¶ä¸Šä¼ 
```
âœ… æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼æ­£åœ¨åå°è§£æå’Œåˆ†ç±»...
```

#### æ‰¹é‡ä¸Šä¼ 
```
ğŸ‰ æ‰¹é‡ä¸Šä¼ å®Œæˆï¼æˆåŠŸä¸Šä¼  {count} ä¸ªæ–‡ä»¶
âš ï¸ æ‰¹é‡ä¸Šä¼ å®Œæˆï¼æˆåŠŸ {success} ä¸ªï¼Œå¤±è´¥ {failed} ä¸ª
âŒ æ‰¹é‡ä¸Šä¼ å¤±è´¥ï¼{failed} ä¸ªæ–‡ä»¶ä¸Šä¼ å¤±è´¥
```

---

## è¾¹ç•Œæƒ…å†µå¤„ç†

### 1. ç©ºæ–‡ä»¶
```
IF file.size == 0:
    message.error("æ–‡ä»¶ä¸ºç©ºï¼Œæ— æ³•ä¸Šä¼ ")
    RETURN
```

### 2. æ–‡ä»¶åè¿‡é•¿
```
IF filename.length > 255:
    truncate_filename(filename)
    message.warning("æ–‡ä»¶åè¿‡é•¿ï¼Œå·²è‡ªåŠ¨æˆªæ–­")
```

### 3. ç‰¹æ®Šå­—ç¬¦
```
IF filename contains special_chars:
    sanitize_filename(filename)
    message.info("æ–‡ä»¶ååŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œå·²è‡ªåŠ¨å¤„ç†")
```

### 4. é‡åæ–‡ä»¶
```
IF file_exists(filename):
    new_filename = add_timestamp(filename)
    message.info("æ–‡ä»¶åé‡å¤ï¼Œå·²è‡ªåŠ¨é‡å‘½å")
```

### 5. ç½‘ç»œä¸­æ–­
```
IF upload_interrupted:
    retry_count++
    IF retry_count < 3:
        auto_retry()
    ELSE:
        message.error("ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•")
```

### 6. æœåŠ¡å™¨ç¹å¿™
```
IF server_error_503:
    message.error("æœåŠ¡å™¨ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•")
    enable_retry_button()
```

---

## æ€§èƒ½è¾¹ç•Œ

### æ¨èé…ç½®

| åœºæ™¯ | æ¨èå€¼ | æœ€å¤§å€¼ |
|------|--------|--------|
| å•æ–‡ä»¶å¤§å° | < 10MB | 50MB |
| æ‰¹é‡æ–‡ä»¶æ•° | 5-10ä¸ª | 20ä¸ª |
| æ‰¹é‡æ€»å¤§å° | < 100MB | 500MB |
| å¹¶å‘ä¸Šä¼  | 3ä¸ª | 5ä¸ª |

### æ€§èƒ½é¢„æœŸ

| æ–‡ä»¶å¤§å° | ä¸Šä¼ æ—¶é—´ | è§£ææ—¶é—´ | åˆ†ç±»æ—¶é—´ | æ€»æ—¶é—´ |
|----------|----------|----------|----------|--------|
| < 1MB | 0.3s | 0.5s | 3s | ~4s |
| 1-5MB | 0.5s | 1s | 3s | ~5s |
| 5-10MB | 1s | 2s | 4s | ~7s |
| 10-50MB | 2-5s | 3-10s | 5s | ~15s |

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–

**æ‰¹é‡ä¸Šä¼ å»ºè®®**ï¼š
```
åœºæ™¯1ï¼šå¤§é‡å°å›¾ç‰‡ï¼ˆå¦‚ç…§ç‰‡æ•´ç†ï¼‰
- æ¨èï¼šæ¯æ‰¹10-15ä¸ª
- å¹¶å‘ï¼š5ä¸ª
- é¢„æœŸï¼šæ¯æ‰¹20-30ç§’

åœºæ™¯2ï¼šå°‘é‡å¤§PDFï¼ˆå¦‚æŠ¥å‘Šæ–‡æ¡£ï¼‰
- æ¨èï¼šæ¯æ‰¹3-5ä¸ª
- å¹¶å‘ï¼š2ä¸ª
- é¢„æœŸï¼šæ¯æ‰¹30-60ç§’

åœºæ™¯3ï¼šæ··åˆç±»å‹
- æ¨èï¼šæ¯æ‰¹5-10ä¸ª
- å¹¶å‘ï¼š3ä¸ªï¼ˆæ™ºèƒ½è°ƒæ•´ï¼‰
- é¢„æœŸï¼šæ¯æ‰¹15-30ç§’
```

---

## ç›‘æ§ä¸å‘Šè­¦

### å®æ—¶ç›‘æ§æŒ‡æ ‡

```javascript
// å‰ç«¯ç›‘æ§
{
    uploadSuccessRate: 0.95,  // ä¸Šä¼ æˆåŠŸç‡
    avgUploadTime: 0.5,       // å¹³å‡ä¸Šä¼ æ—¶é—´ï¼ˆç§’ï¼‰
    avgProcessTime: 8,        // å¹³å‡å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰
    activeUploads: 3,         // å½“å‰æ´»è·ƒä¸Šä¼ æ•°
    queuedFiles: 5            // æ’é˜Ÿæ–‡ä»¶æ•°
}
```

```python
# åç«¯ç›‘æ§
{
    'active_tasks': 15,        # æ´»è·ƒä»»åŠ¡æ•°
    'queue_size': 10,          # é˜Ÿåˆ—ç§¯å‹
    'failed_tasks': 2,         # å¤±è´¥ä»»åŠ¡æ•°
    'avg_task_time': 5.5,      # å¹³å‡ä»»åŠ¡æ—¶é—´
    'storage_used': '2.3GB'    # å­˜å‚¨ä½¿ç”¨é‡
}
```

### å‘Šè­¦è§„åˆ™

```
ğŸ”´ ç´§æ€¥å‘Šè­¦ï¼š
- ä¸Šä¼ æˆåŠŸç‡ < 80%
- é˜Ÿåˆ—ç§¯å‹ > 100ä¸ªä»»åŠ¡
- å­˜å‚¨ç©ºé—´ < 1GB
- æœåŠ¡å®•æœº

ğŸŸ¡ è­¦å‘Šå‘Šè­¦ï¼š
- ä¸Šä¼ æˆåŠŸç‡ < 90%
- å¹³å‡å¤„ç†æ—¶é—´ > 15ç§’
- é˜Ÿåˆ—ç§¯å‹ > 50ä¸ªä»»åŠ¡
- å­˜å‚¨ç©ºé—´ < 5GB

ğŸŸ¢ æ­£å¸¸è¿è¡Œï¼š
- ä¸Šä¼ æˆåŠŸç‡ >= 95%
- å¹³å‡å¤„ç†æ—¶é—´ < 10ç§’
- é˜Ÿåˆ—ç§¯å‹ < 20ä¸ªä»»åŠ¡
```

---

## ç”¨æˆ·ä½¿ç”¨å»ºè®®

### æœ€ä½³å®è·µ

1. **æ–‡ä»¶å‡†å¤‡**
   - ç¡®ä¿æ–‡ä»¶æ ¼å¼æ­£ç¡®
   - å‹ç¼©å¤§å›¾ç‰‡ï¼ˆæ¨è<5MBï¼‰
   - åˆå¹¶å°æ–‡æœ¬æ–‡ä»¶

2. **æ‰¹é‡ä¸Šä¼ **
   - æ¯æ‰¹ä¸è¶…è¿‡10ä¸ªæ–‡ä»¶
   - æ§åˆ¶æ€»å¤§å°åœ¨100MBä»¥å†…
   - ç­‰å¾…å½“å‰æ‰¹æ¬¡å®Œæˆå†ä¸Šä¼ ä¸‹æ‰¹

3. **ç½‘ç»œç¯å¢ƒ**
   - ä½¿ç”¨ç¨³å®šçš„ç½‘ç»œè¿æ¥
   - é¿å…åœ¨é«˜å³°æ—¶æ®µå¤§é‡ä¸Šä¼ 
   - ç§»åŠ¨ç½‘ç»œå»ºè®®å•ä¸ªæ–‡ä»¶ä¸Šä¼ 

4. **é”™è¯¯å¤„ç†**
   - æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯
   - ä½¿ç”¨é‡è¯•åŠŸèƒ½
   - å¿…è¦æ—¶åˆ†æ‰¹é‡æ–°ä¸Šä¼ 

### å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆä¸æ”¯æŒWord/Excel/PPTï¼Ÿ**
A: ç›®å‰ä¼˜å…ˆæ”¯æŒå¸¸ç”¨æ ¼å¼ï¼ŒOfficeæ–‡æ¡£æ”¯æŒéœ€è¦é¢å¤–çš„ä¾èµ–åº“ã€‚å¯ä»¥å…ˆå°†è¿™äº›æ–‡æ¡£è½¬æ¢ä¸ºPDFæ ¼å¼ä¸Šä¼ ã€‚

**Q: ä¸Šä¼ 20ä¸ªæ–‡ä»¶åä¸ºä»€ä¹ˆä¸èƒ½ç»§ç»­ä¸Šä¼ ï¼Ÿ**
A: å•æ¬¡é™åˆ¶20ä¸ªæ–‡ä»¶æ˜¯ä¸ºäº†ç¡®ä¿å¤„ç†è´¨é‡å’Œé€Ÿåº¦ã€‚è¯·ç­‰å¾…å½“å‰æ‰¹æ¬¡å®Œæˆåï¼Œå¯ä»¥ç»§ç»­ä¸Šä¼ æ–°çš„æ‰¹æ¬¡ã€‚

**Q: ä¸ºä»€ä¹ˆå¤§æ–‡ä»¶å¤„ç†è¿™ä¹ˆæ…¢ï¼Ÿ**
A: å¤§æ–‡ä»¶éœ€è¦æ›´é•¿çš„è§£ææ—¶é—´ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒæ•´è½®è¯¢ç­–ç•¥ï¼Œè¯·è€å¿ƒç­‰å¾…æˆ–ç¨ååˆ·æ–°é¡µé¢æŸ¥çœ‹ç»“æœã€‚

**Q: å¦‚æœä¸Šä¼ å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
A: ç³»ç»Ÿä¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯åŸå› ï¼Œæ‚¨å¯ä»¥ï¼š
1. ç‚¹å‡»"é‡è¯•"æŒ‰é’®
2. æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå¤§å°
3. æ£€æŸ¥ç½‘ç»œè¿æ¥
4. è”ç³»ç®¡ç†å‘˜

---

## é…ç½®å‚æ•°æ±‡æ€»

### å‰ç«¯é…ç½®

```typescript
// frontend/src/pages/Home/index.tsx

const UPLOAD_CONFIG = {
    // æ–‡ä»¶æ ¼å¼
    acceptFormats: '.txt,.md,.pdf,.jpg,.jpeg,.png,.gif,.bmp,.webp',
    
    // æ•°é‡é™åˆ¶
    maxFiles: 20,
    
    // å¤§å°é™åˆ¶
    maxSingleSize: 50 * 1024 * 1024,      // 50MBï¼ˆè­¦å‘Šï¼‰
    maxTotalSize: 500 * 1024 * 1024,      // 500MBï¼ˆæ‹’ç»ï¼‰
    
    // å¹¶å‘æ§åˆ¶
    concurrency: {
        smallFile: 5,   // <1MB
        mediumFile: 3,  // 1-10MB
        largeFile: 2    // >10MB
    },
    
    // è½®è¯¢é…ç½®
    polling: {
        image: { maxPolls: 20, interval: 1000 },
        largeFile: { maxPolls: 60, interval: 2000 },
        normal: { maxPolls: 40, interval: 1500 }
    }
};
```

### åç«¯é…ç½®

```python
# backend/app/api/ingest.py

UPLOAD_CONFIG = {
    # æ•°é‡é™åˆ¶
    'max_files_per_batch': 20,
    
    # å¤§å°é™åˆ¶
    'max_total_size': 500 * 1024 * 1024,  # 500MB
    
    # é˜Ÿåˆ—é…ç½®
    'queues': {
        'quick': {'priority': 9-10},
        'classify': {'priority': 8},
        'heavy': {'priority': 7-8}
    },
    
    # ä»»åŠ¡å»¶è¿Ÿ
    'task_delays': {
        'parse': 0.1,
        'quick_classify': 2,
        'ai_classify': 4,
        'collection_match': 10
    }
}
```

### Nginxé…ç½®

```nginx
# å®¢æˆ·ç«¯è¯·æ±‚ä½“å¤§å°é™åˆ¶
client_max_body_size 100M;

# è¯·æ±‚è¶…æ—¶æ—¶é—´
client_body_timeout 60s;
send_timeout 60s;

# è¿æ¥è¶…æ—¶
keepalive_timeout 65s;
```

---

## æ€»ç»“

### âœ… è¾¹ç•Œä¿æŠ¤å®Œå–„æ€§

1. **æ ¼å¼éªŒè¯**ï¼šâœ… å‰ç«¯accept + åç«¯is_supported
2. **æ•°é‡é™åˆ¶**ï¼šâœ… å‰ç«¯éªŒè¯ + åç«¯éªŒè¯ï¼ˆåŒé‡ä¿æŠ¤ï¼‰
3. **å¤§å°é™åˆ¶**ï¼šâœ… å‰ç«¯éªŒè¯ + åç«¯éªŒè¯ï¼ˆåŒé‡ä¿æŠ¤ï¼‰
4. **æ€§èƒ½ä¿æŠ¤**ï¼šâœ… æ™ºèƒ½å¹¶å‘ + è¶…æ—¶æœºåˆ¶
5. **ç”¨æˆ·æç¤º**ï¼šâœ… æ¸…æ™°çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯

### ğŸ“Š éªŒè¯è¦†ç›–ç‡

- å‰ç«¯éªŒè¯ï¼š80%ï¼ˆæ–°å¢åï¼‰
- åç«¯éªŒè¯ï¼š100%
- ç”¨æˆ·æç¤ºï¼š90%
- é”™è¯¯æ¢å¤ï¼š85%

### ğŸ¯ ç”¨æˆ·ä½“éªŒè¯„åˆ†

- æ¸…æ™°åº¦ï¼šâ­â­â­â­â­ï¼ˆ5/5ï¼‰
- å®‰å…¨æ€§ï¼šâ­â­â­â­â­ï¼ˆ5/5ï¼‰
- å‹å¥½æ€§ï¼šâ­â­â­â­ï¼ˆ4/5ï¼‰- æ”¹è¿›ç©ºé—´ï¼šæ›´è¯¦ç»†çš„å¸®åŠ©æ–‡æ¡£

**ç»“è®º**ï¼šè¾¹ç•Œä¿æŠ¤æœºåˆ¶å®Œå–„ï¼Œç”¨æˆ·æç¤ºæ¸…æ™°ï¼Œæ»¡è¶³ç”Ÿäº§ç¯å¢ƒè¦æ±‚ã€‚

