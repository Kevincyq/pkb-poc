# 问题追踪和修复计划

## 问题清单

### ✅ 问题1：搜索功能不稳定 + 结果无法跳转
**状态**: 🔍 检查中
**优先级**: P0

**子问题**:
1. 搜索结果不稳定（有时能搜到，有时搜不到）
2. 搜索结果无法点击跳转到合集并高亮文件

**检查点**:
- [ ] 后端搜索算法一致性
- [ ] 前端SearchOverlay点击事件
- [ ] 跳转逻辑实现
- [ ] 高亮参数传递

---

### ✅ 问题2：特定图片预览失败
**状态**: 🔍 检查中
**优先级**: P1

**现象**: `迪士尼景酒套餐.jpg` 无法预览，其他图片正常

**检查点**:
- [ ] 文件名中文编码
- [ ] 数据库source_uri记录
- [ ] 文件实际存储路径
- [ ] URL编码/解码逻辑

---

### ✅ 问题3：标签体系建立和显示
**状态**: 🔍 检查中
**优先级**: P1

**需求**: 
- 从AI分析结果提取关键词作为标签
- 预览时显示标签列表

**检查点**:
- [ ] Tag表是否有数据
- [ ] AI分析是否提取关键词
- [ ] 关键词是否写入ContentTag
- [ ] 前端预览是否显示标签

---

### ✅ 问题4：系统合集与用户合集关联
**状态**: 🔍 检查中
**优先级**: P0

**需求**:
- 一个文件：1个primary_system + N个user_rule
- 自动匹配用户自建合集
- 删除时物理删除

**检查点**:
- [ ] CollectionMatchingService逻辑
- [ ] ContentCategory的role字段设置
- [ ] 合集查询是否返回所有关联文件
- [ ] 删除逻辑是否正确

---

### ✅ 问题5：问答结果文件链接缺失
**状态**: 🔍 检查中
**优先级**: P1

**需求**: 相关文档文件名应该是可点击链接，跳转到合集并高亮

**检查点**:
- [ ] QA API返回数据结构
- [ ] 前端AIChat组件渲染
- [ ] 链接URL格式
- [ ] 跳转和高亮逻辑

---

## 修复顺序

1. **问题4**（最核心，影响其他问题）
2. **问题2**（阻塞用户使用）
3. **问题1**（用户体验关键）
4. **问题3**（功能增强）
5. **问题5**（功能恢复）

